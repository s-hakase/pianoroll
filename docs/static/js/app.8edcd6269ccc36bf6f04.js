webpackJsonp([0],{"8RGA":function(t,e){},DAS2:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),r=[30,40,40,30,30,40,30],o={KEY_NAMES:["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],KEY_NAMES_ONLY_WHITE:["B","A","G","F","E","D","C"],OCTAVE_KEYS:[0,1,0,1,0,1,0,0,1,0,1,0],WHITE_KEYS_HEIGHT:r,WHITE_KEYS_Y:r.map(function(t,e,n){return n.reduce(function(t,n,a){return a<e?t+n:t},0)}),OCTAVE_HEIGHT:r.reduce(function(t,e){return t+e},0),BLACK_KEY_HEIGHT:20,LINE_HEIGHT:20,X_AXIS_INTERVAL:16,X_AXIS_OFFSET:8,SELECTS_SNAP:[{label:"1/4 Step",value:.25},{label:"1/2 Step",value:.5},{label:"1/4 Beat",value:1},{label:"1/2 Beat",value:2},{label:"1 Beat",value:4,default:"true"}]},i=0,s={data:{currentKey:"",currentOctave:"",currentSnappedPosition:[-9999,-9999],selectedSnap:4,latestWidth:4,notes:[],clicked:0,dragging:!1},methods:{setCurrentKey:function(t){s.data.currentKey=t},setCurrentOctave:function(t){s.data.currentOctave=t},setCurrentKeyAndOctave:function(t){var e=t.length;if(0===e)return s.data.currentKey="",void(s.data.currentOctave="");s.data.currentKey=t.substring(0,e-1),s.data.currentOctave=t.substring(e-1,e)},setCurrentSnappedPosition:function(t){s.data.currentSnappedPosition=[t[0]-t[0]%(s.data.selectedSnap*o.X_AXIS_INTERVAL),t[1]-t[1]%o.LINE_HEIGHT]},addNote:function(t){t.id="note-"+i,s.data.notes.push(t),i++,this.selectNoteByIds([])},selectNoteByIds:function(t){s.data.notes.forEach(function(e){var n=t.findIndex(function(t){return e.id===t});e.selected=n>-1})},removeNote:function(t){s.data.notes=s.data.notes.filter(function(e){return-1===t.findIndex(function(t){return e.id===t})})},setLatestWidth:function(t){s.data.latestWidth=t},getNotes:function(t){return s.data.notes.filter(function(e){return t.findIndex(function(t){return e.id===t})>-1})},setDragging:function(t){s.data.dragging=t}}},u=s,c={data:function(){return{KeyStore:u.data,constant:o}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"Header"}},[n("header",{staticClass:"header"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.KeyStore.selectedSnap,expression:"KeyStore.selectedSnap"}],attrs:{name:"snap"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.KeyStore,"selectedSnap",e.target.multiple?n:n[0])}}},t._l(t.constant.SELECTS_SNAP,function(e){return n("option",{key:e.value,domProps:{value:e.value,selected:!!e.default}},[t._v(t._s(e.label))])})),t._v(" "),n("span",[t._v(t._s(t.KeyStore.currentKey)+t._s(t.KeyStore.currentOctave))]),t._v(" "),n("span",[t._v(t._s(t.KeyStore.currentSnappedPosition))])])])},staticRenderFns:[]};var l={name:"App",components:{Header:n("VU/8")(c,d,!1,function(t){n("8RGA")},null,null).exports}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("Header"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var f=n("VU/8")(l,h,!1,function(t){n("cBFt")},null,null).exports,p=n("/ocq"),v={data:function(){return{constant:o}},props:["width","x","y","classname","keyname"],computed:{lineY:function(){return this.y+this.constant.LINE_HEIGHT}},methods:{setCurrentKey:function(t){u.methods.setCurrentKey(t)}}},y={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",[n("rect",{class:t.classname,attrs:{width:t.width,height:t.constant.LINE_HEIGHT,x:t.x,y:t.y},on:{mouseover:function(e){t.setCurrentKey(t.keyname)},mouseout:function(e){t.setCurrentKey("")}}}),t._v(" "),n("line",{attrs:{x1:t.x,x2:t.x+t.width,y1:t.lineY,y2:t.lineY}})])},staticRenderFns:[]};var m=n("VU/8")(v,y,!1,function(t){n("zmcr")},"data-v-6c4aea77",null).exports,_={props:["width","height","x"],data:function(){return{axes:[]}},filters:{getClass:function(t){return t%16==0?"measure":t%4==0?"beat":""}},watch:{width:function(t){this.axes=function(){for(var e=[],n=o.X_AXIS_OFFSET;n<t;n+=o.X_AXIS_INTERVAL)e.push(n);return e}()}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{staticClass:"xaxis"},t._l(t.axes,function(e,a){return n("line",{key:e,class:t._f("getClass")(a),attrs:{x1:e+t.x,x2:e+t.x,y1:"0",y2:t.height}})}))},staticRenderFns:[]};var S=n("VU/8")(_,g,!1,function(t){n("dfMd")},"data-v-66575513",null).exports,E={props:["x","y","width","keyname","selected","id","editable"],data:function(){return{rectWidth:this.width*o.X_AXIS_INTERVAL,areaWidth:12,KeyStore:u.data}},computed:{textX:function(){return this.x+2},textY:function(){return this.y+15}},methods:{setCurrentKeyAndOctave:function(t){u.methods.setCurrentKeyAndOctave(t)},select:function(){u.methods.selectNoteByIds([this.id])},remove:function(t){2===u.data.clicked&&u.methods.removeNote([this.id])},updateMouseStatus:function(t){u.data.clicked=t.buttons},updateMousePositionAtPianoRoll:function(t){var e=t.offsetX,n=t.offsetY;u.methods.setCurrentSnappedPosition([e,n])},startDrag:function(t){this.$emit("dragstart",this.id),t.stopPropagation()}},watch:{width:function(t){this.rectWidth=t*o.X_AXIS_INTERVAL}}},w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",{class:{selected:t.selected,dragging:t.KeyStore.dragging},on:{mouseover:function(e){t.setCurrentKeyAndOctave(t.keyname)},mouseout:function(e){t.setCurrentKeyAndOctave(""),t.updateMouseStatus(e)},mousemove:function(e){t.updateMousePositionAtPianoRoll(e),t.remove(e)},mousedown:function(e){t.updateMouseStatus(e),t.remove(e)},mouseup:function(e){t.updateMouseStatus(e)},click:t.select}},[n("rect",{staticClass:"note",attrs:{x:t.x,y:t.y,rx:"2",ry:"2",width:t.rectWidth,height:"20"}}),t._v(" "),n("text",{attrs:{x:t.textX,y:t.textY}},[t._v(t._s(t.keyname))]),t._v(" "),t.editable?n("rect",{staticClass:"side",attrs:{x:t.x+t.rectWidth-t.areaWidth,y:t.y,height:"20",width:t.areaWidth},on:{mousedown:t.startDrag}}):t._e()])},staticRenderFns:[]};var K=n("VU/8")(E,w,!1,function(t){n("exxz")},"data-v-98880162",null).exports;Pico.pause();var x="",A=null,C=-9999,k=-9999,I={props:["height","width","offsetX","octaves"],data:function(){return{constant:o,KeyStore:u.data,dragging:!1}},components:{PianoRollLine:m,XAxis:S,Note:K},computed:{octaveHeight:function(){return 12*o.LINE_HEIGHT}},methods:{setCurrentOctave:function(t){u.methods.setCurrentOctave(t)},play:function(t){if(Pico&&Sionic)if(t&&1===t.buttons&&"mouseout"!==t.type&&u.data.currentOctave&&u.data.currentKey&&!u.data.dragging){var e=u.data.currentKey.toLowerCase(),n="t1;o"+u.data.currentOctave+e.split("#").join("+");x!==n&&(this.pause(),Pico.play(Sionic(n)),x=n)}else this.pause()},pause:function(){Pico.pause(),x=""},updateMousePositionAtPianoRoll:function(t){var e=t.offsetX,n=t.offsetY;u.methods.setCurrentSnappedPosition([e,n])},updateMouseStatus:function(t){u.data.clicked=t.buttons,1!==u.data.clicked&&u.methods.setDragging(!1),t.preventDefault()},addNote:function(){u.data.dragging||1!==u.data.clicked||u.methods.addNote({x:u.data.currentSnappedPosition[0],y:u.data.currentSnappedPosition[1],width:u.data.latestWidth,keyname:u.data.currentKey+u.data.currentOctave,selected:!1})},startDrag:function(t){u.methods.setDragging(!0),A=u.methods.getNotes([t])[0],k=A.width,C=u.data.currentSnappedPosition[0]},changeWidth:function(t){if(u.data.dragging){var e=(u.data.currentSnappedPosition[0]-C)/this.constant.X_AXIS_INTERVAL;A.width=Math.max(k+e-u.data.selectedSnap,u.data.selectedSnap),u.methods.setLatestWidth(A.width)}}}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",[n("rect",{attrs:{height:t.height,width:t.width,x:t.offsetX}}),t._v(" "),t._l(t.octaves,function(e,a){return n("g",{key:a,on:{mouseover:function(n){t.setCurrentOctave(e.value)},mouseout:function(e){t.updateMouseStatus(e),t.setCurrentOctave(""),t.play(e)},mousedown:function(e){t.updateMouseStatus(e),t.play(e)},mouseup:function(e){t.addNote(),t.updateMouseStatus(e),t.play(e)},mousemove:function(e){t.play(e),t.updateMousePositionAtPianoRoll(e),t.changeWidth(e)}}},t._l(t.constant.OCTAVE_KEYS,function(e,r){return n("PianoRollLine",{key:a+"-"+r,attrs:{classname:0===e?"white":"black",keyname:t.constant.KEY_NAMES[r],width:t.width,height:t.constant.LINE_HEIGHT,x:t.offsetX,y:r*t.constant.LINE_HEIGHT+a*t.octaveHeight}})}))}),t._v(" "),n("XAxis",{attrs:{height:t.height,width:t.width,x:t.offsetX}}),t._v(" "),t._l(t.KeyStore.notes,function(e){return n("Note",{key:e.id,attrs:{x:e.x,y:e.y,width:e.width,keyname:e.keyname,selected:e.selected,id:e.id,editable:!0},on:{dragstart:t.startDrag}})}),t._v(" "),t.KeyStore.dragging||1!==t.KeyStore.clicked?t._e():n("Note",{staticClass:"pointer-none",attrs:{x:t.KeyStore.currentSnappedPosition[0],y:t.KeyStore.currentSnappedPosition[1],width:t.KeyStore.latestWidth,keyname:t.KeyStore.currentKey+t.KeyStore.currentOctave,selected:!1,editable:!1}})],2)},staticRenderFns:[]};var N=n("VU/8")(I,H,!1,function(t){n("DAS2")},"data-v-22001ff7",null).exports,P={data:function(){return{computedWidth:this.width}},props:["classname","width","height","y","keyname"],mounted:function(){this.computedWidth=this.width,"black"===this.classname&&(this.computedWidth*=.7)},methods:{setCurrentKey:function(t){u.methods.setCurrentKey(t)}}},T={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",[n("rect",{class:t.classname,attrs:{width:t.computedWidth,y:t.y,height:t.height},on:{mouseover:function(e){t.setCurrentKey(t.keyname)},mouseout:function(e){t.setCurrentKey("")}}}),t._v(" "),"white"===t.classname?n("line",{attrs:{x1:"0",x2:t.width,y1:t.y+t.height,y2:t.y+t.height}}):t._e()])},staticRenderFns:[]};var O={data:function(){return{keys:[],constant:o}},props:["height","width","octaves"],components:{Key:n("VU/8")(P,T,!1,function(t){n("pq2i")},"data-v-773cab11",null).exports},mounted:function(){this.keys=o.WHITE_KEYS_HEIGHT.map(function(t,e){return{height:t,y:o.WHITE_KEYS_Y[e],keyname:o.KEY_NAMES_ONLY_WHITE[e]}})},methods:{setCurrentOctave:function(t){u.methods.setCurrentOctave(t)}}},W={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",[n("rect",{attrs:{height:t.height,width:t.width}}),t._v(" "),t._l(t.octaves,function(e,a){return n("g",{key:"white-"+e.value,on:{mouseover:function(n){t.setCurrentOctave(e.value)},mouseout:function(e){t.setCurrentOctave("")}}},[n("g",{staticClass:"white-keys"},t._l(t.keys,function(e){return n("Key",{key:e.y,attrs:{classname:"white",width:t.width,height:e.height,y:e.y+a*t.constant.OCTAVE_HEIGHT,keyname:e.keyname}})}))])}),t._v(" "),t._l(t.octaves,function(e,a){return n("g",{key:"black-"+e.value,on:{mouseover:function(n){t.setCurrentOctave(e.value)},mouseout:function(e){t.setCurrentOctave("")}}},[n("g",{staticClass:"black-keys"},t._l(t.keys,function(e,r){return r%7!=3&&r%7!=6?n("Key",{key:e.y,attrs:{classname:"black",width:t.width,height:t.constant.BLACK_KEY_HEIGHT,y:e.y+e.height-10+a*t.constant.OCTAVE_HEIGHT,keyname:t.constant.KEY_NAMES_ONLY_WHITE[r+1]+"#"}}):t._e()}))])})],2)},staticRenderFns:[]};var R={name:"PianoRollContainer",data:function(){return{height:300,width:300,previewWidth:120,octaves:[{value:6},{value:5},{value:4}]}},components:{PianoRoll:N,Preview:n("VU/8")(O,W,!1,function(t){n("kAj5")},"data-v-775ac960",null).exports},mounted:function(){this.width=document.documentElement.clientWidth,this.height=document.documentElement.clientHeight}},X={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"PianoRoll"}},[n("svg",{attrs:{height:t.height,width:t.width},on:{contextmenu:function(t){t.preventDefault()}}},[n("defs",[n("linearGradient",{attrs:{id:"WhiteKeyGradient"}},[n("stop",{attrs:{offset:"5%","stop-color":"#dbe2e9"}}),t._v(" "),n("stop",{attrs:{offset:"90%","stop-color":"#ffffff"}})],1),t._v(" "),n("linearGradient",{attrs:{id:"BlackKeyGradient"}},[n("stop",{attrs:{offset:"5%","stop-color":"#46484B"}}),t._v(" "),n("stop",{attrs:{offset:"90%","stop-color":"#5b5d5f"}})],1)],1),t._v(" "),n("PianoRoll",{attrs:{height:t.height,width:t.width-t.previewWidth,offsetX:t.previewWidth,octaves:t.octaves}}),t._v(" "),n("Preview",{attrs:{height:t.height,width:t.previewWidth,octaves:t.octaves}})],1)])},staticRenderFns:[]};var b=n("VU/8")(R,X,!1,function(t){n("peNJ")},null,null).exports;a.a.use(p.a);var L=new p.a({routes:[{path:"/",name:"PianoRollContainer",component:b}]});a.a.config.productionTip=!1,new a.a({el:"#app",router:L,components:{App:f},template:"<App/>"})},cBFt:function(t,e){},dfMd:function(t,e){},exxz:function(t,e){},kAj5:function(t,e){},peNJ:function(t,e){},pq2i:function(t,e){},zmcr:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.8edcd6269ccc36bf6f04.js.map